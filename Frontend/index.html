<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Wyatt Mogelson">
    <title>Login Page</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div style = "text-align: center;"> 
        <div>
            <h1 class = "font"> <img src = "/images/instagram_logo.svg" width="24.004" height="24" title="instagram_logo"> Instagram Unfollower Tool </h1>
        </div>
        <hr>
        <div class = "form-box">
            <div class = "button-box">
                <div id="switch-btn"></div>
                <button class = "toggle-btn" id = "to-login" onclick="toLogin()">Login</button>
                <button class =  "toggle-btn" id = "to-register" onclick="toRegister()">Register</button>
        </div>
        <!-- <div>
            <h2>Login</h2>
        </div> -->
        <form id = "login-screen" class="input-group">
            <input class = "input-field", type ="text" id = "username" placeholder="Enter Username">
            <br><br>
            <input class = "input-field" type ="text" id = "password" placeholder="Enter Password">
            <p class = "font" id = "message"><br></p>
            <input type="checkbox" class="check-box"><span>Keep me logged in</span>
            <button class = "login-btn" id = "login">Login</button>
            <!-- <p>Haven't made an account?</p><a href="views/register.html">Register</a> -->
        </form>
        <form id = "register-screen" class="input-group">
            <input class = "input-field", type ="text" id = "username" placeholder="Enter New Username">
            <br><br>
            <input class = "input-field" type ="text" id = "password" placeholder="Enter New Password">
            <p class = "font" id = "message"><br></p>
            <input type="checkbox" class="check-box"><span>I agree to the terms & conditions</span>
            <button class = "login-btn" id = "register">Register</button>
        </form>
        <script>
            const loginBtn = document.getElementById("login") 
            const password = document.getElementById("password")
            const username = document.getElementById("username")
            const baseUrl = 'http://localhost:8383'

            loginBtn.addEventListener('click', login)

            var login_screen = document.getElementById("login-screen")
            var register_screen = document.getElementById("register-screen") 
            var switchBtn = document.getElementById("switch-btn") 
            function toRegister(){
                login_screen.style.left = "-400px"
                register_screen.style.left = "50px"
                switchBtn.style.left = "110px"
            }
            function toLogin(){
                login_screen.style.left = "50px"
                register_screen.style.left = "450px"
                switchBtn.style.left = "0px"
            }
            async function login(e) {
                e.preventDefault()
                const formData = new FormData()
                if (!username.value || !password.value) {
                    document.getElementById("message").textContent = "Incorrect username or password"
                    return;
                }
                formData.append("password", password.value)
                formData.append("username", username.value)
                const res = await fetch(baseUrl + '/login', {
                    method: 'POST',
                    body: formData
                  
                })
                if (res.ok) {
                    window.location.href = 'views/main.html';
                }
                else {
                    if (res.status === 400) {
                        // Display username or password incorrect
                        document.getElementById("message").textContent = "Incorrect username or password"
                    }
                    else {
                        document.getElementById("message").textContent = "Error during login, try again later"
                        // Display error during login, try again later
                    }
                }
                // else {
                //     const result = await res.json(); // Or use .json() if the server responds with JSON
    
                // }
            }
        </script>
    </div>
</body>
</html>